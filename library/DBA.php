<?phpClass DB{ var $con; var $myID; var $query_error;  function __construct() {  $this->connect(); }  function connect() {  try  {   $this->con = mysql_connect(DB_HOST,DB_USER,DB_PWD);  }  catch(Exception $e)  {   die('Error in database connectivity. Details:<br>'.print_r($e,true));  }  if(!$this->con)  {   echo "There was an error connecting to the database. Details: ".mysql_error();   die;  }  mysql_select_db(DB_NAME,$this->con); } 
 function q($str,&$error='') {  $q = array();  if(preg_match("[SUPERADMIN]",$str)&&$_SESSION['adminType']!="SUPERADMIN")  {   @$q->error="Invalid query. You do not have sufficient rights to execute this query!";   return $q;  }  if(!$this->con)  {   $this->connect();  }  $q = mysql_query($str,$this->con);  if(!$q)  {   $q = false;   $this->error="Error in query: $str<br>Error: ".mysql_error($this->con);   $error = $this->error;  }  // if(mysql_error($this->con))   // $q['err']="Error in query '".$str."'.<br><b>Details: ".mysql_error($this->con)."</b>";  return $q; } 
 function insert($str) {  $this->q($str);  $id = mysql_insert_id($this->con);  if(mysql_error($this->con))  {   $this->q('SET lc_messages = "en_US"');   echo "<br><b>Error in insert operation</b> for query: '".$str."'. Details<b>: ".mysql_error($this->con)."</b>";   return;  }  return $id; }  function fetch($q,$table=null) {   return $this->fetchAll($q,true); }  function fetchAll($q,$get_one=false) {   if(is_string($q))//if a query was sent, rather than a query result   $q = $this->q($q);  if(isset($q->error))   return $q;  else if(!count($q))   return false;  $row=array();   for($i=0; $res = mysql_fetch_array($q); $i++)   {    $keys=array_keys($res);    foreach($keys as $key)    {     if(!is_string($key))//skips numeric keys  	  continue;     $row[$i][$key]=$res[$key];    }   }  if(!count($row))   return false;  else if($get_one)   $row = $row[0];  return $row; }}